((h,e)=>{XF.OffCanvasBuilder.acpNav=(a,b)=>{XF.on(a,"off-canvas:opening",()=>{a.style.position=""})};XF.AdminNav=XF.Element.newHandler({options:{topOffset:".p-header",sectionTogglers:".js-navSectionToggle",toggleTarget:".p-nav-section",toggleSubTarget:".p-nav-listSection",navTester:"| .js-navTester"},init(){XF.onDelegated(this.target,"click",this.options.sectionTogglers,this.togglerClick.bind(this))},isOffCanvas(){const a=XF.findRelativeIf(this.options.navTester,this.target);return a?"off-canvas"==
h.getComputedStyle(a).getPropertyValue("font-family").replace(/"/g,""):!1},togglerClick(a){a.preventDefault();const b=a.target.closest(this.options.toggleTarget),c=this.options.toggleSubTarget;Array.from(b.parentNode.children).filter(d=>d!==b).forEach(d=>{XF.Transition.removeClassTransitioned(d,"is-active");Array.from(d.querySelectorAll(c)).forEach(f=>XF.Transition.removeClassTransitioned(f,"is-active"))});XF.Transition.toggleClassTransitioned(b,"is-active",()=>XF.layoutChange());Array.from(b.querySelectorAll(c)).forEach(d=>
XF.Transition.toggleClassTransitioned(d,"is-active"))}});XF.AdminSearch=XF.Element.newHandler({options:{input:"| .js-adminSearchInput",results:"| .js-adminSearchResults",resultsWrapper:"| .js-adminSearchResultsWrapper",toggleClass:"is-active"},input:null,results:null,resultsWrapper:null,abortcontroller:null,init(){const a=this.target;this.input=XF.findRelativeIf(this.options.input,a);this.results=XF.findRelativeIf(this.options.results,a);this.resultsWrapper=XF.findRelativeIf(this.options.resultsWrapper,
a);XF.on(a,"submit",this.submit.bind(this));XF.on(this.input,"keydown",this.keyDown.bind(this));XF.watchInputChangeDelayed(this.input,()=>{XF.trigger(a,"submit")})},submit(a){a.preventDefault();a=this.target;const b=this.results,c=this.resultsWrapper,d=this.options.toggleClass;this.input.value.trim().length?(this.abortController&&(this.abortController.abort(),this.abortcontroller=null),{abortController:a}=XF.ajaxAbortable("post",a.getAttribute("action"),a,f=>{f.html&&XF.setupHtmlInsert(f.html,(k,
m,l)=>{k?(b.innerHTML="",b.append(k),l(),c.classList.add(d),XF.Transition.addClassTransitioned(b,d),b.querySelectorAll("a").forEach(g=>{XF.on(g,"mouseenter",()=>g.classList.add("is-active"));XF.on(g,"mouseleave",()=>g.classList.remove("is-active"))})):this.emptyResults()})}),a&&(this.abortcontroller=a)):this.emptyResults()},emptyResults(){const a=this.results,b=this.resultsWrapper,c=this.options.toggleClass;XF.Transition.removeClassTransitioned(a,c,()=>{a.innerHTML="";b.classList.remove(c)})},keyDown(a){switch(a.key){case "ArrowUp":this.menuNavigate(-1);
a.stopPropagation();break;case "ArrowDown":this.menuNavigate(1);a.stopPropagation();break;case "Enter":this.menuSelect()&&a.stopPropagation()}},menuNavigate(a){const b=Array.from(this.results.querySelectorAll("a")),c=b.find(d=>d.classList.contains("is-active"));a=b.indexOf(c)+a;b.forEach(d=>d.classList.remove("is-active"));0>a?a=b.length-1:a>=b.length&&(a=0);b[a].classList.add("is-active");b[a].focus();this.input.focus()},menuSelect(){const a=this.results.querySelector("a.is-active");if(a)return h.location=
a.getAttribute("href"),!0}});XF.AdminToggleAdvanced=XF.Element.newHandler({options:{url:null,value:null},init(){e.documentElement.classList.contains("acp--simple-mode")&&this.unhideLinkedOption();XF.on(this.target,"click",this.click.bind(this))},unhideLinkedOption(){var a=h.location.hash.replace(/[^a-zA-Z0-9_-]/g,"");a&&(a=e.querySelector(`span#${a}.u-anchorTarget`).nextElementSibling)&&a.classList.contains("acp--advanced")&&(XF.display(a),XF.layoutChange())},click(a){let b;if(null!==this.options.value)b=
this.options.value?1:0;else if("checkbox"===this.target.type)b=this.target.checked?1:0;else{console.error("Admin toggler must be a checkbox or provide a data-value");return}this.options.url&&XF.ajax("POST",this.options.url,{advanced:b});e.querySelectorAll(".js-advancedModeToggle").forEach(c=>{"checkbox"===c.type&&(c.checked=!!b)});e.documentElement.classList.toggle("acp--advanced-mode",!!b);e.documentElement.classList.toggle("acp--simple-mode",!b);XF.layoutChange()}});XF.AdminAssetEditor=XF.Element.newHandler({options:{},
init(){this.target.querySelectorAll(".js-assetModify").forEach(a=>{XF.on(a,"click",this.modifyClick.bind(this))})},modifyClick(a){a=a.currentTarget;const b=a.parentElement;a.classList.contains("is-modify")?this.enableEditing(b):a.classList.contains("is-revert")&&this.revertToParent(b)},enableEditing(a){const b=a.querySelector(".js-assetKey"),c=a.querySelector(".js-assetValue");a=a.querySelector(".js-assetModify");b.disabled=!1;c.disabled=!1;c.dataset.parentValue||(c.dataset.parentValue=c.value);a.classList.remove("is-modify");
a.classList.add("is-revert")},revertToParent(a){const b=a.querySelector(".js-assetKey"),c=a.querySelector(".js-assetValue");a=a.querySelector(".js-assetModify");b.disabled=!0;c.disabled=!0;c.value=c.dataset.parentValue;a.classList.remove("is-revert");a.classList.add("is-modify")}});XF.Element.register("admin-toggle-advanced","XF.AdminToggleAdvanced");XF.Element.register("admin-nav","XF.AdminNav");XF.Element.register("admin-search","XF.AdminSearch");XF.Element.register("admin-asset-editor","XF.AdminAssetEditor")})(window,
document);
