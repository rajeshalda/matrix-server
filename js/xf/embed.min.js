((g,f)=>{XF.OembedFetcher=XF.Element.newHandler({options:{provider:"",id:""},init(){this.options.provider&&this.options.id&&XF.ajax("get",XF.canonicalizeUrl("oembed.php"),{provider:this.options.provider,id:this.options.id.replace(/#/,"{{_hash_}}")}).then(a=>this.handleResponse(a))},handleResponse({data:a,response:b}){b=b.headers.get("X-Oembed-Retain-Scripts");XF.hasOwn(a,"html")?this.insertOembedHtml(a,"1"===b):"photo"==a.type?this.insertOembedImage(a):XF.hasOwn(a,"xf-oembed-error")&&this.oembedFetchError(a)},
insertOembedHtml(a,b){if(void 0===a.html)return!1;XF.setupHtmlInsert({content:a.html},(c,d,e)=>{this.target.classList.add("bbOembed--loaded");this.target.replaceWith(c);e(!0,this.target);this.onComplete()},b)},insertOembedImage(a){const b=XF.createElement("a",{className:"bbImage",dataset:{zoomTarget:1}});Object.entries(this.getImageLinkData(a)).forEach(([c,d])=>{b.setAttribute(c,d)});XF.createElement("img",{onload:this.onComplete,src:a.url},b);this.target.innerHTML="";this.target.appendChild(b)},
oembedFetchError(a){this.target.classList.add("bbOembed--failure");console.warn("Unable to fetch %s media id: %s",this.options.provider,this.options.id)},getImageLinkData(a){const b={rel:"external",target:"_blank"};Object.entries({href:["web_page","web_page_short_url","author_url"],title:["title"],"data-author":["author_name"]}).forEach(([c,d])=>{d.some(e=>XF.hasOwn(a,e)?(b[c]=a[e],!0):!1)});return b},onComplete(){const a={};a[this.options.provider]=!0;XF.config.jsState=XF.applyJsState(XF.config.jsState,
a);XF.trigger(f,"embed:loaded");XF.layoutChange()}});XF.TweetRenderer=XF.Element.newHandler({options:{tweetId:null,lang:"en",dnt:"true",related:null,via:null,conversation:"all",cards:"visible",align:null,theme:"light",linkColor:"#2b7bb9"},init(){const a=String(this.options.tweetId);g.twttr&&a.length&&twttr.ready(b=>{b.widgets.createTweet(a,this.target,this.options).then(()=>{this.target.querySelector("a").remove();XF.trigger(f,"embed:loaded");XF.layoutChange()})})}});XF.Element.register("oembed",
"XF.OembedFetcher");XF.Element.register("tweet","XF.TweetRenderer")})(window,document);
