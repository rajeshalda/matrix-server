!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ExifReader=e():t.ExifReader=e()}("undefined"!=typeof self?self:this,(function(){return function(){"use strict";var t={d:function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:1,get:n[r]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r:function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:1})}},e={};function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return t+""}(t);return"symbol"==n(e)?e:e+""}t.r(e),t.d(e,{default:function(){return wt},errors:function(){return Et},load:function(){return It},loadView:function(){return Ot}});var o=function(){return t=function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t){return"object"!==n(t)||void 0===t.length||void 0===t.readUInt8||void 0===t.readUInt16LE||void 0===t.readUInt16BE||void 0===t.readUInt32LE||void 0===t.readUInt32BE||void 0===t.readInt32LE||void 0===t.readInt32BE}(e))throw Error("DataView: Passed buffer type is unsupported.");this.buffer=e,this.byteLength=this.buffer.length},(e=[{key:"getUint8",value:function(t){return this.buffer.readUInt8(t)}},{key:"getUint16",value:function(t,e){return e?this.buffer.readUInt16LE(t):this.buffer.readUInt16BE(t)}},{key:"getUint32",value:function(t,e){return e?this.buffer.readUInt32LE(t):this.buffer.readUInt32BE(t)}},{key:"getInt32",value:function(t,e){return e?this.buffer.readInt32LE(t):this.buffer.readInt32BE(t)}}])&&function(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||0,o.configurable=1,"value"in o&&(o.writable=1),Object.defineProperty(t,r(o.key),o)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:0}),t;var t,e}();function i(t,e,n){try{return new DataView(t,e,n)}catch(r){return new o(t,e,n)}}function u(t,e,n){for(var r=[],o=0;o<n&&e+o<t.byteLength;o++)r.push(t.getUint8(e+o));return r.map((function(t){return String.fromCharCode(t)})).join("")}function a(t,e){var n=t.getUint8(e);return[n,u(t,e+1,n)]}function f(){for(var t=1;t<arguments.length;t++)for(var e in arguments[t])arguments[0][e]=arguments[t][e];return arguments[0]}function c(t,e){return Array(e+1).join(t)}var d={USE_FILE:1,USE_JFIF:1,USE_PNG_FILE:1,USE_EXIF:1,USE_IPTC:1,USE_XMP:1,USE_ICC:1,USE_MPF:1,USE_PHOTOSHOP:1,USE_THUMBNAIL:1,USE_TIFF:1,USE_JPEG:1,USE_PNG:1,USE_HEIC:1,USE_AVIF:1,USE_WEBP:1,USE_GIF:1};function l(t){return t[0][0]/t[0][1]+t[1][0]/t[1][1]/60+t[2][0]/t[2][1]/3600}var s=2,p=65496,h=2,g=4,y=2,m=10,v=65472,b=65474,S=65476,A=65499,U=65501,w=65498,E=65504,I=65505,P=65519,O=65534,T=65535,L="Exif";function F(t,e){var n=L.length;return t.getUint16(e)===I&&u(t,e+g,n)===L&&0===t.getUint8(e+g+n)}function C(t,e){var n=t.getUint16(e);return n>=E&&n<=P||n===O||n===v||n===b||n===S||n===A||n===U||n===w}function x(t,e){return t.getUint16(e)===T}var k={parseAppMarkers:function(t,e){if(function(t){return!!t&&t.byteLength>=s&&t.getUint16(0)===p}(t))return f({},function(t){for(var e,n,r=h;r+g+5<=t.byteLength;){if(F(t,r))e=t.getUint16(r+y),n=r+m;else{if(!C(t,r)){if(x(t,r)){r++;continue}break}e=t.getUint16(r+y)}r+=y+e}return{hasAppMarkers:r>h,fileDataOffset:void 0,jfifDataOffset:void 0,tiffHeaderOffset:n,iptcDataOffset:void 0,xmpChunks:void 0,iccChunks:void 0,mpfDataOffset:void 0}}(t),{fileType:{value:"jpeg",description:"JPEG"}});throw Error("Invalid image format")}},B=18761,M=B,N={271:"Make",272:"Model",306:"DateTime",34665:"Exif IFD Pointer"},j={ApertureValue:function(t){return Math.pow(Math.sqrt(2),t[0]/t[1]).toFixed(2)},ColorSpace:function(t){return 1===t?"sRGB":65535===t?"Uncalibrated":"Unknown"},ComponentsConfiguration:function(t){return t.map((function(t){return 49===t?"Y":50===t?"Cb":51===t?"Cr":52===t?"R":53===t?"G":54===t?"B":void 0})).join("")},Contrast:function(t){return 0===t?"Normal":1===t?"Soft":2===t?"Hard":"Unknown"},CustomRendered:function(t){return 0===t?"Normal process":1===t?"Custom process":"Unknown"},ExposureMode:function(t){return 0===t?"Auto exposure":1===t?"Manual exposure":2===t?"Auto bracket":"Unknown"},ExposureProgram:function(t){return 0===t?"Undefined":1===t?"Manual":2===t?"Normal program":3===t?"Aperture priority":4===t?"Shutter priority":5===t?"Creative program":6===t?"Action program":7===t?"Portrait mode":8===t?"Landscape mode":9===t?"Bulb":"Unknown"},ExposureTime:function(t){if(t[0]/t[1]>.25){var e=t[0]/t[1];return Number.isInteger(e)?""+e:e.toFixed(1)}return 0!==t[0]?"1/".concat(Math.round(t[1]/t[0])):"0/".concat(t[1])},FNumber:function(t){return"f/".concat(t[0]/t[1])},FocalLength:function(t){return t[0]/t[1]+" mm"},FocalPlaneResolutionUnit:function(t){return 2===t?"inches":3===t?"centimeters":"Unknown"},LightSource:function(t){return 1===t?"Daylight":2===t?"Fluorescent":3===t?"Tungsten (incandescent light)":4===t?"Flash":9===t?"Fine weather":10===t?"Cloudy weather":11===t?"Shade":12===t?"Daylight fluorescent (D 5700 – 7100K)":13===t?"Day white fluorescent (N 4600 – 5400K)":14===t?"Cool white fluorescent (W 3900 – 4500K)":15===t?"White fluorescent (WW 3200 – 3700K)":17===t?"Standard light A":18===t?"Standard light B":19===t?"Standard light C":20===t?"D55":21===t?"D65":22===t?"D75":23===t?"D50":24===t?"ISO studio tungsten":255===t?"Other light source":"Unknown"},MeteringMode:function(t){return 1===t?"Average":2===t?"CenterWeightedAverage":3===t?"Spot":4===t?"MultiSpot":5===t?"Pattern":6===t?"Partial":255===t?"Other":"Unknown"},ResolutionUnit:function(t){return 2===t?"inches":3===t?"centimeters":"Unknown"},Saturation:function(t){return 0===t?"Normal":1===t?"Low saturation":2===t?"High saturation":"Unknown"},SceneCaptureType:function(t){return 0===t?"Standard":1===t?"Landscape":2===t?"Portrait":3===t?"Night scene":"Unknown"},Sharpness:function(t){return 0===t?"Normal":1===t?"Soft":2===t?"Hard":"Unknown"},ShutterSpeedValue:function(t){var e=Math.pow(2,t[0]/t[1]);return e<=1?"".concat(Math.round(1/e)):"1/".concat(Math.round(e))},WhiteBalance:function(t){return 0===t?"Auto white balance":1===t?"Manual white balance":"Unknown"},XResolution:function(t){return""+Math.round(t[0]/t[1])},YResolution:function(t){return""+Math.round(t[0]/t[1])}};function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function D(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=R(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=R(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return t+""}(t);return"symbol"==R(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:1,configurable:1,writable:1}):t[e]=n,t}var G=f({},N,{33434:{name:"ExposureTime",description:j.ExposureTime},33437:{name:"FNumber",description:j.FNumber},34855:"ISOSpeedRatings",36867:"DateTimeOriginal",37385:{name:"Flash",description:function(t){return 0===t?"Flash did not fire":1===t?"Flash fired":5===t?"Strobe return light not detected":7===t?"Strobe return light detected":9===t?"Flash fired, compulsory flash mode":13===t?"Flash fired, compulsory flash mode, return light not detected":15===t?"Flash fired, compulsory flash mode, return light detected":16===t?"Flash did not fire, compulsory flash mode":24===t?"Flash did not fire, auto mode":25===t?"Flash fired, auto mode":29===t?"Flash fired, auto mode, return light not detected":31===t?"Flash fired, auto mode, return light detected":32===t?"No flash function":65===t?"Flash fired, red-eye reduction mode":69===t?"Flash fired, red-eye reduction mode, return light not detected":71===t?"Flash fired, red-eye reduction mode, return light detected":73===t?"Flash fired, compulsory flash mode, red-eye reduction mode":77===t?"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected":79===t?"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected":89===t?"Flash fired, auto mode, red-eye reduction mode":93===t?"Flash fired, auto mode, return light not detected, red-eye reduction mode":95===t?"Flash fired, auto mode, return light detected, red-eye reduction mode":"Unknown"}},37386:{name:"FocalLength",description:j.FocalLength}}),z="0th",_="exif",H="interoperability",V=D(D(D(D(D(D({},z,G),"1st",N),_,G),"gps",{}),H,{}),"mpf",{}),W={1:1,2:1,3:2,4:4,5:8,7:1,9:4,10:8,13:4},q={BYTE:1,ASCII:2,SHORT:3,LONG:4,RATIONAL:5,UNDEFINED:7,SLONG:9,SRATIONAL:10,IFD:13},J={getAsciiValue:function(t){return t.map((function(t){return String.fromCharCode(t)}))},getByteAt:K,getAsciiAt:function(t,e){return t.getUint8(e)},getShortAt:function(t,e,n){return t.getUint16(e,n===M)},getLongAt:Y,getRationalAt:function(t,e,n){return[Y(t,e,n),Y(t,e+4,n)]},getUndefinedAt:function(t,e){return K(t,e)},getSlongAt:X,getSrationalAt:function(t,e,n){return[X(t,e,n),X(t,e+4,n)]},getIfdPointerAt:function(t,e,n){return Y(t,e,n)},typeSizes:W,tagTypes:q,getTypeSize:function(t){if(void 0===q[t])throw Error("No such type found.");return W[q[t]]}};function K(t,e){return t.getUint8(e)}function Y(t,e,n){return t.getUint32(e,n===M)}function X(t,e,n){return t.getInt32(e,n===M)}var $={1:J.getByteAt,2:J.getAsciiAt,3:J.getShortAt,4:J.getLongAt,5:J.getRationalAt,7:J.getUndefinedAt,9:J.getSlongAt,10:J.getSrationalAt,13:J.getIfdPointerAt};function Q(t,e,n,r,o,i){var u=J.getTypeSize("SHORT"),a={},f=function(t,e,n){return e+J.getTypeSize("SHORT")<=t.byteLength?J.getShortAt(t,e,n):0}(t,r,o);r+=u;for(var c=0;c<f&&!(r+12>t.byteLength);c++){var l=Z(t,e,n,r,o,i);void 0!==l&&(a[l.name]={id:l.id,value:l.value,description:l.description}),r+=12}if(d.USE_THUMBNAIL&&r<t.byteLength-J.getTypeSize("LONG")){var s=J.getLongAt(t,r,o);0!==s&&e===z&&(a.Thumbnail=Q(t,"1st",n,n+s,o,1))}return a}function Z(t,e,n,r,o,i){var u,a=J.getTypeSize("SHORT"),f=a+J.getTypeSize("SHORT"),c=f+J.getTypeSize("LONG"),d=J.getShortAt(t,r,o),l=J.getShortAt(t,r+a,o),s=J.getLongAt(t,r+f,o);if(void 0!==J.typeSizes[l]&&(i||void 0!==V[e][d])){if(function(t,e){return J.typeSizes[t]*e<=J.getTypeSize("LONG")}(l,s))u=tt(t,r+c,l,s,o);else{var p=J.getLongAt(t,r+c,o);u=function(t,e,n,r,o){return e+n+J.typeSizes[r]*o<=t.byteLength}(t,n,p,l,s)?tt(t,n+p,l,s,o,33723===d):"<faulty value>"}l===J.tagTypes.ASCII&&(u=function(t){try{return t.map((function(t){return decodeURIComponent(escape(t))}))}catch(e){return t}}(u=function(t){for(var e=[],n=0,r=0;r<t.length;r++)"\0"!==t[r]?(void 0===e[n]&&(e[n]=""),e[n]+=t[r]):n++;return e}(u)));var h="undefined-".concat(d),g=u;if(void 0!==V[e][d])if(void 0!==V[e][d].name&&void 0!==V[e][d].description){h=V[e][d].name;try{g=V[e][d].description(u)}catch(t){g=et(u)}}else l===J.tagTypes.RATIONAL||l===J.tagTypes.SRATIONAL?(h=V[e][d],g=""+u[0]/u[1]):(h=V[e][d],g=et(u));return{id:d,name:h,value:u,description:g}}}function tt(t,e,n,r,o){var i=[];arguments.length>5&&void 0!==arguments[5]&&arguments[5]&&(r*=J.typeSizes[n],n=J.tagTypes.BYTE);for(var u=0;u<r;u++)i.push($[n](t,e,o)),e+=J.typeSizes[n];return n===J.tagTypes.ASCII?i=J.getAsciiValue(i):1===i.length&&(i=i[0]),i}function et(t){return t instanceof Array?t.join(", "):t}var nt="Exif IFD Pointer",rt="GPS Info IFD Pointer",ot="Interoperability IFD Pointer",it={read:function(t,e,n){var r=function(t,e){if(t.getUint16(e)===B)return B;if(19789===t.getUint16(e))return 19789;throw Error("Illegal byte order value. Faulty image.")}(t,e),o=function(t,e,n,r){return Q(t,z,e,function(t,e,n){return e+J.getLongAt(t,e+4,n)}(t,e,n),n,r)}(t,e,r,n);return function(t,e,n,r,o){return void 0!==t[ot]?f(t,Q(e,H,n,n+t[ot].value,r,o)):t}(o=function(t,e,n,r,o){return void 0!==t[rt]?f(t,Q(e,"gps",n,n+t[rt].value,r,o)):t}(o=function(t,e,n,r,o){return void 0!==t[nt]?f(t,Q(e,_,n,n+t[nt].value,r,o)):t}(o,t,e,r,n),t,e,r,n),t,e,r,n)}};function ut(t){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ut(t)}function at(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=ut(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=ut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return t+""}(t);return"symbol"==ut(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:1,configurable:1,writable:1}):t[e]=n,t}function ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var ct={2e3:{name:"PathInformation",description:function(t){for(var e={},n=[],r=0;r<t.byteLength;r+=26){var o=J.getShortAt(t,r);dt[o]&&(e[o]||(e[o]=dt[o].description),n.push({type:o,path:dt[o].path(t,r+2)}))}return JSON.stringify({types:e,paths:n})}},2999:{name:"ClippingPathName",description:function(t){return(e=a(t,0),2,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,u,a=[],f=1,c=0;try{for(i=(n=n.call(t)).next,!2;!(f=(r=i.call(n)).done)&&(a.push(r.value),2!==a.length);f=1);}catch(t){c=1,o=t}finally{try{if(!f&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw o}}return a}}(e)||function(t,e){if(t){if("string"==typeof t)return ft(t,2);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ft(t,2):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[1];var e}}},dt=at(at(at(at(at(at(at(at(at({},0,{description:"Closed subpath length",path:function(t,e){return[J.getShortAt(t,e)]}}),1,{description:"Closed subpath Bezier knot, linked",path:lt}),2,{description:"Closed subpath Bezier knot, unlinked",path:lt}),3,{description:"Open subpath length",path:function(t,e){return[J.getShortAt(t,e)]}}),4,{description:"Open subpath Bezier knot, linked",path:lt}),5,{description:"Open subpath Bezier knot, unlinked",path:lt}),6,{description:"Path fill rule",path:function(){return[]}}),8,{description:"Initial fill rule",path:function(t,e){return[J.getShortAt(t,e)]}}),7,{description:"Clipboard",path:function(t,e){return[[pt(t,e,8),pt(t,e+4,8),pt(t,e+8,8),pt(t,e+12,8)],pt(t,e+16,8)]}});function lt(t,e){for(var n=[],r=0;r<24;r+=8)n.push(st(t,e+r));return n}function st(t,e){var n=pt(t,e,8);return[pt(t,e+4,8),n]}function pt(t,e,n){var r,o=J.getLongAt(t,e),i=o>>>31==0?1:-1,u=(2130706432&o)>>>32-n,a=o&parseInt(c("1",32-n),2);return i*function(t,e){return parseInt(t.replace(".",""),2)/Math.pow(2,(t.split(".")[1]||"").length)}(u.toString(2)+"."+(c("0",32-n-(r=a.toString(2)).length)+r))}function ht(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var gt={read:function(t,e){for(var n=i(new Uint8Array(t).buffer),r={},o=0;o<t.length;){var a=u(n,o,bt);o+=bt;var f=J.getShortAt(n,o),c=St(n,o+=mt),d=c.tagName;o+=c.tagNameSize;var l=J.getLongAt(n,o);if(o+=vt,a===yt){var s=i(n.buffer,o,l),p={id:f,value:u(s,0,l)};if(ct[f]){try{p.description=ct[f].description(s)}catch(t){p.description="<no description formatter>"}r[d||ct[f].name]=p}else e&&(r["undefined-".concat(f)]=p)}o+=l+l%2}return r}},yt="8BIM",mt=2,vt=4,bt=yt.length;function St(t,e){var n,r=(2,function(t){if(Array.isArray(t))return t}(n=a(t,e))||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,u,a=[],f=1,c=0;try{for(i=(n=n.call(t)).next,!2;!(f=(r=i.call(n)).done)&&(a.push(r.value),2!==a.length);f=1);}catch(t){c=1,o=t}finally{try{if(!f&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw o}}return a}}(n)||function(t,e){if(t){if("string"==typeof t)return ht(t,2);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ht(t,2):void 0}}(n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0];return{tagName:r[1],tagNameSize:1+o+(o%2==0?1:0)}}function At(t){this.name="MetadataMissingError",this.message=t||"No Exif data",this.stack=Error().stack}At.prototype=Error();var Ut={MetadataMissingError:At},wt={load:It,loadView:Ot,errors:Ut},Et=Ut;function It(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t){return"string"==typeof t}(t)?(n.async=1,function(t,e){return/^\w+:\/\//.test(t)?"undefined"!=typeof fetch?function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).length,n={method:"GET"};return Number.isInteger(e)&&e>=0&&(n.headers={range:"bytes=0-".concat(e-1)}),fetch(t,n).then((function(t){return t.arrayBuffer()}))}(t,e):function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).length;return new Promise((function(n,r){var o={};Number.isInteger(e)&&e>=0&&(o.headers={range:"bytes=0-".concat(e-1)});var i=function(t){return/^https:\/\//.test(t)?require("https").get:require("http").get}(t);i(t,o,(function(t){if(t.statusCode>=200&&t.statusCode<=299){var e=[];t.on("data",(function(t){return e.push(Buffer.from(t))})),t.on("error",(function(t){return r(t)})),t.on("end",(function(){return n(Buffer.concat(e))}))}else r("Could not fetch file: ".concat(t.statusCode," ").concat(t.statusMessage)),t.resume()})).on("error",(function(t){return r(t)}))}))}(t,e):function(t){return/^data:[^;,]*(;base64)?,/.test(t)}(t)?Promise.resolve(function(t){var e=t.substring(t.indexOf(",")+1);if(-1!==t.indexOf(";base64")){if("undefined"!=typeof atob)return Uint8Array.from(atob(e),(function(t){return t.charCodeAt(0)})).buffer;if("undefined"==typeof Buffer)return;return"undefined"!=typeof Buffer.from?Buffer.from(e,"base64"):new Buffer(e,"base64")}var n=decodeURIComponent(e);return"undefined"!=typeof Buffer?"undefined"!=typeof Buffer.from?Buffer.from(n):new Buffer(n):Uint8Array.from(n,(function(t){return t.charCodeAt(0)})).buffer}(t)):function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).length;return new Promise((function(n,r){var o=function(){try{return require("fs")}catch(t){return}}();o.open(t,(function(i,u){i?r(i):o.stat(t,(function(i,a){if(i)r(i);else{var f=Math.min(a.size,void 0!==e?e:a.size),c=Buffer.alloc(f),d={buffer:c,length:f};o.read(u,d,(function(e){e?r(e):o.close(u,(function(e){e&&console.warn("Could not close file ".concat(t,":"),e),n(c)}))}))}}))}))}))}(t,e)}(t,n).then((function(t){return Pt(t,n)}))):function(t){return"undefined"!=typeof window&&"undefined"!=typeof File&&t instanceof File}(t)?(n.async=1,(e=t,new Promise((function(t,n){var r=new FileReader;r.onload=function(e){return t(e.target.result)},r.onerror=function(){return n(r.error)},r.readAsArrayBuffer(e)}))).then((function(t){return Pt(t,n)}))):Pt(t,n)}function Pt(t,e){return function(t){try{return Buffer.isBuffer(t)}catch(t){return 0}}(t)&&(t=new Uint8Array(t).buffer),Ot(function(t){try{return new DataView(t)}catch(e){return new o(t)}}(t),e)}function Ot(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{expanded:0,async:0,includeUnknown:0},n=e.expanded,r=void 0===n?0:n,o=e.async,i=void 0===o?0:o,u=e.includeUnknown,a=void 0===u?0:u,c=0,s={},p=k.parseAppMarkers(t,i),h=p.fileType,g=(p.fileDataOffset,p.jfifDataOffset,p.tiffHeaderOffset);if(p.iptcDataOffset,p.xmpChunks,p.iccChunks,p.mpfDataOffset,p.pngHeaderOffset,p.pngTextChunks,p.pngChunkOffsets,p.vp8xChunkOffset,p.gifHeaderOffset,function(t){return void 0!==t}(g)){c=1;var y=it.read(t,g,a);if(y.Thumbnail&&(s.Thumbnail=y.Thumbnail,delete y.Thumbnail),r?(s.exif=y,function(t){if(t.exif){if(t.exif.GPSLatitude&&t.exif.GPSLatitudeRef)try{t.gps=t.gps||{},t.gps.Latitude=l(t.exif.GPSLatitude.value),"S"===t.exif.GPSLatitudeRef.value.join("")&&(t.gps.Latitude=-t.gps.Latitude)}catch(t){}if(t.exif.GPSLongitude&&t.exif.GPSLongitudeRef)try{t.gps=t.gps||{},t.gps.Longitude=l(t.exif.GPSLongitude.value),"W"===t.exif.GPSLongitudeRef.value.join("")&&(t.gps.Longitude=-t.gps.Longitude)}catch(t){}if(t.exif.GPSAltitude&&t.exif.GPSAltitudeRef)try{t.gps=t.gps||{},t.gps.Altitude=t.exif.GPSAltitude.value[0]/t.exif.GPSAltitude.value[1],1===t.exif.GPSAltitudeRef.value&&(t.gps.Altitude=-t.gps.Altitude)}catch(t){}}}(s)):s=f({},s,y),d.USE_PHOTOSHOP&&y.ImageSourceData){var m=gt.read(y.PhotoshopSettings.value,a);r?s.photoshop=m:s=f({},s,m)}}if(delete s.Thumbnail,h&&(r?(s.file||(s.file={}),s.file.FileType=h):s.FileType=h,c=1),!c)throw new Ut.MetadataMissingError;return i?Promise.all([]).then((function(){return s})):s}return e}()}));
//# sourceMappingURL=exif-reader.js.map